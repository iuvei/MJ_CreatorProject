{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        updatePanel: {\n            default: null,\n            type: cc.Node\n        },\n        manifestUrl: {\n            default: null,\n            url: cc.RawAsset\n        },\n        percent: {\n            default: null,\n            type: cc.Label\n        },\n        lblErr: {\n            default: null,\n            type: cc.Label\n        }\n    },\n\n    checkCb: function (event) {\n        cc.log('Code: ' + event.getEventCode());\n        switch (event.getEventCode())\n        {\n            case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:\n                cc.log(\"No local manifest file found, hot update skipped.\");\n                cc.eventManager.removeListener(this._checkListener);\n                break;\n            case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:\n            case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:\n                cc.log(\"Fail to download manifest file, hot update skipped.\");\n                cc.eventManager.removeListener(this._checkListener);\n                break;\n            case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:\n                cc.log(\"Already up to date with the latest remote version.\");\n                cc.eventManager.removeListener(this._checkListener);\n                this.lblErr.string += \"游戏不需要更新\\n\";\n                cc.director.loadScene(\"loading\");\n                break;\n            case jsb.EventAssetsManager.NEW_VERSION_FOUND:\n                this._needUpdate = true;\n                this.updatePanel.active = true;\n                this.percent.string = '00.00%';\n                cc.eventManager.removeListener(this._checkListener);\n                break;\n            default:\n                break;\n        }\n        this.hotUpdate();\n    },\n\n    updateCb: function (event) {\n        var needRestart = false;\n        var failed = false;\n        switch (event.getEventCode())\n        {\n            case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:\n                cc.log('No local manifest file found, hot update skipped.');\n                failed = true;\n                break;\n            case jsb.EventAssetsManager.UPDATE_PROGRESSION:\n                var percent = event.getPercent();\n                var percentByFile = event.getPercentByFile();\n\n                var msg = event.getMessage();\n                if (msg) {\n                    cc.log(msg);\n                }\n                cc.log(percent.toFixed(2) + '%');\n                this.percent.string = percent + '%';\n                break;\n            case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:\n            case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:\n                cc.log('Fail to download manifest file, hot update skipped.');\n                failed = true;\n                break;\n            case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:\n                cc.log('Already up to date with the latest remote version.');\n                failed = true;\n                break;\n            case jsb.EventAssetsManager.UPDATE_FINISHED:\n                cc.log('Update finished. ' + event.getMessage());\n\n                needRestart = true;\n                break;\n            case jsb.EventAssetsManager.UPDATE_FAILED:\n                cc.log('Update failed. ' + event.getMessage());\n\n                this._failCount ++;\n                if (this._failCount < 5)\n                {\n                    this._am.downloadFailedAssets();\n                }\n                else\n                {\n                    cc.log('Reach maximum fail count, exit update process');\n                    this._failCount = 0;\n                    failed = true;\n                }\n                break;\n            case jsb.EventAssetsManager.ERROR_UPDATING:\n                cc.log('Asset update error: ' + event.getAssetId() + ', ' + event.getMessage());\n                break;\n            case jsb.EventAssetsManager.ERROR_DECOMPRESS:\n                cc.log(event.getMessage());\n                break;\n            default:\n                break;\n        }\n\n        if (failed) {\n            cc.eventManager.removeListener(this._updateListener);\n            this.updatePanel.active = false;\n        }\n\n        if (needRestart) {\n            cc.eventManager.removeListener(this._updateListener);\n            // Prepend the manifest's search path\n            var searchPaths = jsb.fileUtils.getSearchPaths();\n            var newPaths = this._am.getLocalManifest().getSearchPaths();\n            Array.prototype.unshift(searchPaths, newPaths);\n            // This value will be retrieved and appended to the default search path during game startup,\n            // please refer to samples/js-tests/main.js for detailed usage.\n            // !!! Re-add the search paths in main.js is very important, otherwise, new scripts won't take effect.\n            cc.sys.localStorage.setItem('HotUpdateSearchPaths', JSON.stringify(searchPaths));\n\n            jsb.fileUtils.setSearchPaths(searchPaths);\n            this.lblErr.string += \"游戏资源更新完毕\\n\";\n            cc.game.restart();\n        }\n    },\n\n    hotUpdate: function () {\n        if (this._am && this._needUpdate) {\n            this.lblErr.string += \"开始更新游戏资源...\\n\";\n            this._updateListener = new jsb.EventListenerAssetsManager(this._am, this.updateCb.bind(this));\n            cc.eventManager.addListener(this._updateListener, 1);\n\n            this._failCount = 0;\n            this._am.update();\n        }\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        // Hot update is only available in Native build\n        if (!cc.sys.isNative) {\n            return;\n        }\n        this.lblErr.string += \"检查游戏资源...\\n\";\n        var storagePath = ((jsb.fileUtils ? jsb.fileUtils.getWritablePath() : '/') + 'tiantianqipai-asset');\n        cc.log('Storage path for remote asset : ' + storagePath);\n        this.lblErr.string += storagePath + \"\\n\";\n        cc.log('Local manifest URL : ' + this.manifestUrl);\n        this._am = new jsb.AssetsManager(this.manifestUrl, storagePath);\n        this._am.retain();\n\n        this._needUpdate = false;\n        if (this._am.getLocalManifest().isLoaded())\n        {\n            this._checkListener = new jsb.EventListenerAssetsManager(this._am, this.checkCb.bind(this));\n            cc.eventManager.addListener(this._checkListener, 1);\n\n            this._am.checkUpdate();\n        }\n    },\n\n    onDestroy: function () {\n        this._am && this._am.release();\n    }\n});\n"
  ]
}